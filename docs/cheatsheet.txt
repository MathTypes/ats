Generate train data:
  - sh -x src/ats/market_data/write_30min.sh data/firstratedata/full 2023-05-01 2023-05-31
  - poetry run python3 src/ats/time_series/read_parquet.py --input= data/FUT/1d/ES/20230501/f2a0b925396a4407a18970af595be56e_000000.parquet
  - sh -x src/ats/market_data/write_daily.sh 2023-05-01 2023-05-31
  - sh -x src/ats/market_data/write_30min.sh tmp 2023-07-01 2023-07-31

To train model
  - poetry run python3 src/ats/app/main.py --config-name=single_asset_mini_futures_train --config-path=/home/ubuntu/ats/conf

To run a job with snapshot generation
  - poetry run python3 src/ats/app/main.py --config-name=single_asset_mini_futures_train --config-path=/home/ubuntu/ats/conf  dataset.write_snapshot=True

To run visual search app
  - generate train examples:
      - poetry run python3 src/ats/app/main.py --config-path=/home/ubuntu/ats/conf --config-name=build_search
      - ls -ltr data/image/20230805-225051/ |awk '{print $9}'|grep -v market > image.txt
      - poetry run python3 src/vss/metrics/generate_meta.py --input=image.txt --output=image_meta.txt
      - cp image_meta.txt data/qdrant_storage/meta_futures.csv
      - cp data/image/20230806-022746/1* data/metric_datasets/futures/
  - train model: poetry run python3 src/vss/metrics/train.py --config-path=/home/ubuntu/ats/conf --config-name=build_search
  - poetry run streamlit run src/vss/interactive/search_app.py --server.port=$INTERACTIVE_PORT --server.address=0.0.0.0

To run with latest data:
  - sh -x src/ats/market_data/refresh.sh

To run main app
  - poetry run streamlit run src/ats/front_end/app.py

To run test
  - poetry run pytest -s   tests/ats/trading/test_trader.py -k test_on_interval
  - poetry run pytest -s --disable-warnings -o log_cli=true  tests/ats/trading/test_trader.py -k test_on_interval
  - quick test: poetry run python3 src/ats/app/main.py --config-name=dev --config-path=/home/ubuntu/ats/conf job.eval_start_date=2011-01-01

To profile
  - poetry run python3 -m memray run -o output.bin  src/ats/app/main.py --config-name=single_asset_simulation --config-path=/home/ubuntu/ats/conf
  - poetry run python3 -m memray flamegraph output.bin

Env
 - pip install --upgrade "jax[cuda11_pip]" -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html
 - pip install nvidia-cuda-cupti-cu11==11.7.101
 - python -m torch.utils.collect_env
 - cp /home/ubuntu/.ats_env/lib/python3.8/site-packages/nvidia/cuda_cupti/lib/libcupti.so.11.7 /home/ubuntu/.local/share/virtualenvs/ubuntu-7Wf190Ea/lib/python3.10/site-packages/nvidia/cuda_cupti/lib/
 - sudo cp  /home/ubuntu/.ats_env/lib/python3.8/site-packages/nvidia/cuda_cupti/lib/libcupti.so.11.7 /usr/lib/x86_64-linux-gnu/ (fixed)


